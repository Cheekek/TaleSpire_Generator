Most of this code is taken from LuPro/SlabelFish and has been modified to work for this project.
Original Repo: https://github.com/LuPro/SlabelFish